# UNIXの歴史と利用

## 歴史

* 1969年、AT&Tのベル研究所でKen Thompson, Dennis M.Ritchie, Brian W.Kernighanらが開発

* 主な特徴
  * 当時肥大化したOSであるMulticsを反省
  * 小さくまとめられ、簡単にネットワークに接続できる

* Ken Thompson
  * カリフォルニア大学バークレー校客員教授
  * 彼を中心として1978年からBSD-UNIXの開発が始まった

* UCB
  * University California Berkeley
  * カリフォルニア大学バークレイ校

* BSD
  * Berkeley Software Distribution
  * バークレイソフトウェア版(UNIX)

### 代表的なUNIXの特徴

* 一般の商用UNIXでの3大UNIX
  * SUNのSoraris
  * HPのHP-UX
  * IBMのAIX

### Soraris(旧SUN/現Oracle社の商用UNIX)

* Bill Joyらが1982年に開発したSUNの最初のOS SunOS1.0は4.1BSDをベースに4.2BSDに先駆けてTCP/IPを搭載した
* このSun OSはV4.1で現在のSolarisに継承されている
* V2でSystem-VベースのUNIXとなる
* V10のSolaris 10(フリー入手可能)とオープンソースとしてのOpenSolarisがある

### HP-UX(HP社の商用UNIX)

* HP社はワークステーションHP9000上で稼働するSVR2.0ベースのUNIXを1985年に発表した
* HP社はその後、アポロコンピュータ社のDomainシステムを統合して今日のHP-UXに発展している

### AIX(IBM社の商用UNIX)

* 1985年にSystem-Vベースに開発されたUNIX
* 当初はRISCチップを搭載したワークステーションRS/6000用のOSだった
* その後、ほかの機種にも広げられる
* 2017年現在、最新はAIX7.2

### FreeBSD(フリーUNIX)

* Linux同様PC上で動作するフリーUNIX
* 1993年開発される
* インストールがコマンド・ベースでありユーザフォーラムが研究グループ的な色彩が強い
  * そのためLinuxのような脚光は浴びていない
* 研究色彩的な技術的特徴により学術研究機関では広く利用されている
* 同様な経緯をたどっているPC用のフリーUNIXにNetBSDがある

## 利用

* UNIXのブート（起動）からユーザ処理受付までの処理ステップ
  * ブート処理から初期化、そしてユーザ処理待ちという、プロセスを実行単位とするマルチプロセス処理

### ブート処理

1. ブートプログラムが稼働して、カーネルをメモリ上にロードする  
1. カーネルがログの開始、リソースの検出・チェック、起動および設定などを行う
1. 最後にinitプログラムを実行する
1. initはシステムのチェックやマウントを行い、以降すべての親プロセスとなる
1. メモリ上に常駐し、全プロセスの起動、設定および制御、ネットワーク・サーバを含む常駐のサーバ・サービスの起動を行う
1. initは最後に、ユーザ独自のアプリケーションを起動するrc.localというスクリプトを実行後、ユーザの利用を可能にする

* これらはシェルスクリプトで実行される
  * シェルスクリプト
    * テキスト形式で書かれた命令ファイルで実行する

## 停止、再起動

* スーパーユーザ(システム管理者,アカウント名：root)が`shutdown`, `reboot`, `halt`コマンドなどを入力することで実行される

* 従来、リモートからは停止・再起動を行うことはできても、電源のONは不可能だった
  * NICのWOL(Wake ON LAN)機能により可能になった

## ログイン処理

1. 実端末ttyポートで起動されるgettyプロセスから始まる
    * telnet接続では疑似端末pty(pseude tty)ポートで行われる
1. そのポートに接続する端末画面に`login:`を表示する
1. ユーザ名を入力するとパスワード・プロンプト(`Password:`)が表示され、ユーザ名に対応したパスワードを入力する（エコーバックなし）
1. この処理を行うloginプログラムはgettyプログラム(実端末時)またはtelnetd(疑似端末時)から起動される
1. ログインした後、loginプログラムは制御をログイン・シェルに渡し、コマンド・プロンプト（コマンド入力可能）状態になる

* ログインにおけるユーザ名は一般的に最大8文字といわれる
  * これはloginプログラムの制限でなくNISの制限によるもの
  * loginではデフォルトでは16文字

## ワード

* 実端末、仮想端末、ttyポート
* 疑似端末、pty(pseude tty)ポート
* getty
  * get teletypeの略
  * ttyを制御するためのUNIX系システムのプログラム
  * 大抵initによって起動される
  * ユーザーからの接続を受けるとユーザー認証のためにユーザー名の入力要求とloginプログラムの起動を行う
* loginプログラム
  * BSD系：/usr/bin/login
  * System-V系：/bin/login
* ログイン・プロンプト
* パスワード・プロンプト
* ログイン・シェル
  * ログイン後に入力されるコマンドの処理を受け持つラッパ
  * ログインして最初に動き出すシェルのこと
* シェル
  * 人間からの入力をコンピュータに伝えるプログラム
* エコーバック
  * CUIにおいて入力したコマンドや文字列などを入力元へ送り返すこと
* NIS(Network Information Service)
  * サン・マイクロシステムズにより開発された、ネットワーク上のコンピュータ間でユーザのアカウント情報やホスト名の情報などを共有し、配布するためのシステム
* カーネル
  * CPUやメモリなどのリソースやタスクを管理するなど、OSの基本部分となるソフトウェア

![ブート処理](./img/BootUnix.svg)