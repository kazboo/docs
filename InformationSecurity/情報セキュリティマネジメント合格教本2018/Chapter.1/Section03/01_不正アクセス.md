# 1. 不正アクセス

## 不正アクセスとは

* 不正アクセス
  * Who
    * システムを利用するもの
  * Where
    * ネットワークを介して
  * What
    * 許可された以上の行為を意図的に行うこと

* IPA定義
  * `不正アクセス禁止法`に定義された不正アクセス行為及び不正アクセスを助長する行為のこと

* 刑法の下、十分に抑止/処罰することができない
  * 補完するのが、`不正アクセス禁止法`

* 不正アクセス禁止法（正式：不正アクセス行為の禁止等に関する法律）
  * 不正アクセス行為、不正アクセス助長行為を禁じる
    * 助長行為：他人のパスワードを流出させるような行為
    * `ネットワークを通じてのアクセス`が対象
  * `アクセスコントロールされているシステム`が保護の対象となる
    * アクセスコントロールの方法自体は問われない

* 不正アクセスの該当事例
  * ネットワークを媒介する
  * セキュリティーホールを突く
  * アクセスコントロールしているシステムへの攻撃
  * 不正IDやパスワードの取得・使用・保管・第三者への提供

* IPA(ユーザ向け)
  * <https://www.ipa.go.jp/files/000011455.pdf>

## 不正アクセスの方法

* 対処のために、不正アクセスの手法を確認しておくことが重要

### ネットワークスキャン

* 目的
  * 不正アクセスの攻撃対象となるコンピュータを特定するための準備行動

* 方法
  * 考えられるあらゆるIPアドレスにpingを実施、相手ノードの存在確認を行う
  * etc

### ポートスキャン

* 前提
  * 対象のコンピュータの存在が確認できた場合

* 目的
  * コンピュータ内部のアプリケーションの動作確認を行う
  * アプリケーションの特定により様々な情報を得ることができる
    * コンピュータがどのような目的で使われているか
    * 管理者はどの程度のスキルをもっているか
    * 既知の脆弱性がアプリケーションにある場合もある
    * etc

* 方法
  * TCPの３ウェイハンドシェイクを利用し、すべてのポートに対して接続要求を行う
  * 接続要求に対して返答のあったポートは解放され、外部からの着信を受け付けている

* 対策
  * 不必要なポートは閉じる
  * 必要なポートを開放する際も、相手のIPアドレスを認証するなどの措置をとる
  * 不特定多数に公開するサーバはDMZにおく、など

### バッファオーバーフロー

* 前提
  * 稼働しているアプリケーションが判明した場合

* 目的
  * 侵入行為を行い、システムに誤作動を引き起こす
  * 送信した任意のプログラムを相手のシステム内で実行する
  * etc

* `セキュリティホールのあるシステム`で特に有効

* 方法
  * Webサーバなどのソフトウェアは、システム上のメモリに配置され実行されている
    * 外部から受け取るデータも同様
  * `メモリの領域(バッファ)を候えるサイズのデータを送信する`　> バッファオーバーフロー攻撃
    * `あらかじめ格納する領域がOSやアプリケーションによって定められている`
    * 本来別のデータが格納される領域にデータがあふれる(フローする)
      * システムに誤作動を引き起こす
      * あふれさせる領域をプログラムの格納領域に指定すれば、送信した任意のプログラムを相手のシステム内で実行することができる
      * `システムの管理権限`を奪うことができる？

``` bufferoverflow

不正データ
|---------------|
:          :    :
|----------|////| 領域の上書きにより、不正動作につながる
用意された
メモリ領域

```

* 対策
  * SW設計・開発時にプログラムにデータ受信時のチェック機構を持たせる
  * しかし、完全なチェックは一般的に困難でセキュリティーホールが発生しがち
    * 発見・配布されたセキュリティパッチを素早く適用することが重要
      * 既知のセキュリティホール情報を常にチェックする

## パスワードの取得

* ユーザIDとパスワードの取得
  * システムに`セキュリティホールがない`場合、`最も簡単に`管理権限を取得する方法

### ブルートフォースアタック(総当たり法、Brute-force attack)

* 管理者のユーザIDは`デフォルト`で運用されることが非常に多い
  * root, admin等

* ブルートフォースアタック
  * 考えられるすべての組み合わせを試す

* 対策
  * 長いパスワードを利用する
    * 特定に時間がかかる
  * パスワードを頻繁に変更する
  * 何回かログインに失敗した場合、アカウントをロックする
    * そのユーザが使用できないようにする

### 辞書攻撃(Dictionary attack)

* ブルートフォースアタックと組み合わせると効果を発揮する方法

* パスワードの候補として利用されがちな単語を体系化したデータベースを利用する
  * 攻撃対象が明確ならば、生年月日、電話番号などを入手してDBに登録する
  * 最終的には総当たりになるが、パスワードを発見するまでの時間が大幅に短縮される

* 対策
  * 辞書に載っているような語はパスワードに用いない
  * 長いパスワードを使用する
  * 小文字、大文字、数字、記号をパスワードに含める
  * 生年月日などの個人情報をパスワードに使用しない

### パスワードリスト攻撃(Password list attack)

* あらかじめ何らかの手段で入手したアカウントとパスワードの対を用いて不正ログインを試行する手法
  * `パスワードを使いまわしている利用者が多い`という傾向を悪用したもの
  * クラッカーが入試した際ほかのサイトでも攻撃を成功させてしまう

* 対策
  * 同じパスワードを使いまわさない

## 侵入後の危険

* 一度不正アクセスに成功した侵入者
  * 証拠の隠滅
  * 再侵入の布石をうつ
  * etc

### ログの消去

* 侵入を行った経路やマシンを特定される可能性があるため、痕跡・証拠を抹消する

* 対策
  * 攻撃者の推測しにくい場所にログファイルを置く
  * ログファイルの暗号化

### バックドアの作成

* 進入路
  * 攻撃者が管理者情報を取得した場合、再度システムに侵入しようと試みる場合がある
  * 同じ手順で侵入できるとは限らない
  * 侵入にかかる手間、時間を短縮する意味からも進入路(バックドア)を確保する

* `特定のポートを開放して、外部からの接続手段を確保するのが一般的`
  * ウイルスがバックドアを作る場合もある

* 以下のプログラムを指す場合もある
  * パスワードの変更やデータの変更といった事象を
    * 攻撃者のもとへ届ける機能
    * 情報漏洩する機能
  * cf) スパイウェア

* 対策
  * パーソナルファイアウォールの導入
  * 受信データだけでなく、送信データもチェックする