# ネットワーク

## 1. ネットワークの基礎

### プロトコル

* プロトコル
  * 通信を行う際に、事前に取り決めるルール
  * 例:日常会話
    * 媒体：空気
    * データリンク：音声
    * プレゼンテーション：日本語

* 通信における最重要概念

* 通信
  * データの送受信を行うこと

### OSI基本参照モデル

* OSI(基本)参照モデル
  * ISOが作ったデータ通信機能におけるモデル
  * 制定された目的
    * `異なる設計思想や世代のシステムと円滑に通信を行うこと`
  * プロトコルを標準化するにあたりどう作成すればよいのかガイドラインを示す
  * プロトコルの階層化を強く推奨している
    * メリット2つ
      * シンプルである
        * 通信プロトコルをシンプルにまとめることができる
        * １つの機能を小さく絞り込むことで安定した通信プログラムを開発できる
          * プロトコルスイート(プロトコルスタック)
          　* 目的の通信をするために必要な通信プロトコルをひと纏めにしたもの
      * 交換が容易である
        * プロトコルが更新された箇所だけを交換することが可能

* 7階層モデルと対応機器の例
  * 通信全体の機能を7分割している
  * 1-4を下位層、5-7を上位層
    * 下位層は通信そのものを制御する
    * 上位層は通信でやり取りされるデータの形などを規定する

|||対応機種|補足|
|:--|:--|:--|:--|:--|
|第7層(Layer7:L7)|アプリケーション層|ゲートウェイ|アプリケーションの世界|
|第6層(Layer6:L6)|プレゼンテーション層|||
|第5層(Layer5:L5)|セッション層|||
|第4層(Layer4:L4)|トランスポート層||トランスポートの世界(TCP/UDP)|
|第3層(Layer3:L3)|ネットワーク層|ルータ、L3スイッチ|IPパケットの世界(IP)|
|第2層(Layer2:L2)|データリンク層|ブリッジ、スイッチングハブ|イーサネットのフレームの世界(MAC), 宛先のみで、IPアドレスや中身を気にしない|
|第1層(Layer1:L1)|物理層|リピータ、ハブ|光、電流(信号)|

* 仮に下位層から上位層まで１つのプロトコルで開発された場合
  * プロトコルが更新されると、それに合わせてシステムのすべての箇所を変更する必要が生じる

### OSI参照モデルの詳細

#### 物理層(第１層)

* システムの物理的、電気的な性質を規定
  * デジタルデータをどのように電流の波形、電圧的な高低に割り付けるのか
  * ケーブルが満たすべき抵抗
  * コネクタピンの形状
  * etc

#### データリンク層(第２層)

* `同じネットワーク`に接続された隣接ノード間での通信について規定

* ブロードキャスト
  * 同じネットワークで接続されているすべてのノードにデータを送達する
  * その範囲を`ブロードキャストドメイン`と呼ぶ
  * MACアドレスの管理も行う

``` cmd
IPアドレスで到達できる範囲
<----------------------------------------------->
[PC]--同じネットワーク--[PC]--同じネットワーク--[PC]
<---------------------->|<---------------------->
MACで到達できる範囲
```

### ネットワーク層(第３層)

* エンドtoエンド（ある端末から様々な端末まで）でのデータのやり取りを規定
  * データリング層のアドレス(MACなど)はローカルネットワーク内だけで有効
  * ネットワーク層で提供されるアドレスにより、ネットワーク超えた通信が可能に

### トランスポート層(第４層)

* データ転送の制御を行う
  * ネットワーク層では通信の品質は保証されないため、それを補完する
    * 伝送エラーの検出、再送
    * ネットワーク全体のスループットを維持したりする機能を提供する
      * ネットワークに流すデータ量を調節する etc
  * ノード内で動作しているアプリケーションを特定する
    * そのための番号を`ポート番号`という

### セッション層(第５層)

* 最終的な通信の目的に合わせてデータの送受信管理を行う
  * コネクション確立やデータ転送のタイミング管理を行い通信特性の差異を吸収
    * チャットのような対話型の通信、ダウンロードのような通信

### プレゼンテーション層(第６層)

* データの表現形式を管理する
  * データの形式がわからないと、伝送されたデータを利用できない
    * 送受信されたデータが圧縮されているのか
    * 文字コードは何が使われているのか

* データ送信の部分と切り離して定義する
  * 新しいデータ形式が表れても、通信機器に影響を及ぼさずに対応できる


### アプリケーション層(第７層)

* やり取りされたデータの意味内容を直接取り扱う
  * メールの規定：SMTP
  * Webアクセスの規定：HTTP
  * それぞれのアプリケーションに特価したプロトコルとなる
  * もっともユーザに近い部分を担当する