# Docker 1

## Dockerとはなにか、なぜ注目されているか

* コンテナとは
  * アプリケーションを依存対象とともにカプセル化したもの
  * VM同様、隔離されたOS環境の中で、アプリケーションを動かす

* VMでは実現が難しい or 不可能なユースケースを可能とする利点がある
  * ホストOSとリソースを共有するため、はるかに効率的
  * コンテナの起動/停止は一瞬ｓ
  * コンテナ内で動くアプリケーションのオーバーヘッドはホストOS上と比較しても極僅か
  * コンテナのポータビリティ(可搬性)には動作環境のわずかな違いによるバグを撲滅できる可能性がある
  * コンテナは軽量なので数十のコンテナを同時に実行できる
    * VMだけを使う場合に比べ、1台のホストマシンではるかに多くのコンテナを実行できる
  * エンドユーザーは容易に複雑なアプリケーションをダウンロードして実行できる
    * アプリケーションの開発者はユーザーの環境や利用可能な依存対象の差異を心配せずに済むようになる

* VMとコンテナのゴール
  * VM: 異なる「環境」を完全にエミュレートすること
  * コンテナ:「アプリケーション」をポータブルにし、単体で動作できるようにすること

### VMとコンテナ

どちらもアプリケーションを同一ホスト上のほかのアプリケーションから隔離するために利用できる

* VM
  * VMを作成して動作させるためにはハイパーバイザー(※1)が必要
    * OS、アプリケーション、必要な支援ライブラリの完全コピーが必要
  * ハイパーバイザのおかげで隔離の度合いが高く、実績による信頼度も高い

* コンテナ
  * VMと異なりホストのカーネル(※2)は実行されるコンテナと共有される
    * 常にホストと同じカーネルを実行しなければならない
  * ハイパーバイザの実行に伴うオーバーヘッドがない
    * コンテナ内で実行しているプロセスはホスト上で直接動作するプロセスと同等
  * 実績がVMと比較すると浅く、VM内でコンテナを実行するハイブリッド型が広くみられる


単一のホスト上で動作している3つのVM
```
 VM1        VM2        VM3
---------- ---------- ----------
|app     | |app     | |app     |
---------- ---------- ----------
|lib     | |lib     | |lib     |
---------- ---------- ----------
|Guest OS| |Guest OS| |Guest OS|
--------------------------------
|Hyper Visor                   |
--------------------------------
|Host OS                       |
--------------------------------
|Hard Ware                     |
--------------------------------
```
単一のホスト上で動作している3つのコンテナ
```
 Co1        Co2        Co3
 」
---------- ---------- ----------
|app     | |app     | |app     |
---------- ---------- ----------
|lib     | |lib     | |lib     |
--------------------------------
|Container Engine              |
--------------------------------
|Host OS                       |
--------------------------------
|Hard Ware                     |
--------------------------------
```

※1 タイプ2のハイパーバイザを指す(VirtualBox, VMWare)  
※2 カーネルはOSの核となる構成要素で、メモリ、CPU、デバイスアクセスに関連する、システムに必須な機能をアプリケーションに提供する

## Dockerとコンテナ