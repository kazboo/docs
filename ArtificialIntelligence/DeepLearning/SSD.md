# SSD(Shingle Shot Multibox Detection)

## 画像分類

* 画像全体に何が写っているかを分類すること

* VGG-16のような画像分類のネットワークに画像をいれると、クラス（ラベル）の各スコアが出力される

* 一番高いものを認識結果とする

## 物体検出

* 画像のどこに何が写っているかを分類すること
  * 画像に複数の物体が写っていても検出できる

## スライディングウィンドウ方式による物体検出

計算量が多くリアルタイム処理が困難

## 従来の一般物体検出アルゴリズム(手法)

* スライディングウィンドウ方式のように画像の中のすべての場所を画像分類するのではなく、物体らしい箇所を検出して、その箇所に対して画像分類をかける
  * R-CNN, Fast R-CNN, Faster R-CNN etc
  * コストは減ったかまだリアルタイム処理が難しいとされる

* 物体検出内の処理が2段階になってしまい、リアルタイム処理が困難とされた
  * 領域候補抽出のためのCNN(Region Proposal Network)
  * さらに物体認識のためのCNN(VGG-16)をかけて画像分類をする

## SSD (Single Shot Mutibox Detector)

* 注目領域を絞り込まない物体検出のためのCNNアーキテクチャ
  * 1度のCNN演算でクラス分類と位置検出の両方を行うことができる
  * 余分な処理がないため、 `高い認識制度` で `高速処理` が可能

* 認識精度(mAP, Mean Average Precision)と性能(FPS)
    ```figure
    (GPU: NVIDIA Titan X)
    Faster R-CNN: 73% mAP /  7 fps
    YOLO:         66% mAP / 21 fps
    SSD512:       77% mAP / 19 fps
    SSD300:       74% mAP / 46 fps
    ```

* より高速なMobilenetベースのSSD(SSD300はVGG-16)やYOLOv2、より精度の高いDSSD、ESSDが登場している

## SSD と YOLO の違い

* 入力画像をCNNに通すと特徴マップがいくつかの異なるスケールで得られる

* SSD
  * スケールの異なる途中の特徴マップからさらにNNを分岐させて、物体のクラスと位置の推論を行う
  * Good: 画像の中にたくさんのオブジェクトが写っている場合の検出に強い
  * Bad: 大きなスケールの特徴抽出が弱い

* YOLO
  * 最後の特徴マップのみ利用して、様々なスケールの物体のクラスと位置の推論を行う
  * Good: 分類できるカテゴリ数が多く、SSDより検出速度が速い
  * Bad: 画像の中にたくさんのオブジェクトが写っている場合の検出に弱い
  * Bad: 特徴マップの解像度が低い

* (注意) 日々ネットワークが改善されているため、一概には言えない

* ライセンス
  * SSD: BSD 2-Clause License(記載すれば商用利用可)
  * YOLO: License Free(自由)

## まとめ：SSDの特徴

* 「物体らしさ」の検出処理を排除し、一度のCNN演算で物体検出を行う